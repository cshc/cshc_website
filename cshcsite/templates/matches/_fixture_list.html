{% comment %}
This re-usable template displays a table of results and fixtures.
Context should have a 'match_list' list of (date, MatchStats) tuples.
{% endcomment %}

{% load core_tags %}

{% if match_list %}
    <table class="table table-condensed table-hover">
        <thead>
            <tr><th class="priority3"></th><th>Date</th><th>Opposition</th><th class="priority2">Time</th><th class="priority2">Venue</th><th class="center-align">Result<br/>(CS-Op)</th><th class="priority3">Scorers</th><th class="priority3">MOM</th><th class="priority3">LOM</th><th>Match<br/>Report</th></tr>
        </thead>
        <tbody>
        {% for date, matches in match_list %}
            {% for m in matches %}
            <tr class="{{ m.match.get_fixture_type_display|lower }}">
                <td class="priority3">
                    {% include 'matches/_fixture_icon.html' with match=m.match %}
                </td>
                <td class="no-break"><a title="Matches on {{ m.match.date|date:"d-M-y" }}" href="{% url 'matches_by_date' m.match.date|date:"d-M-y"%}">{{ m.match.date|date:"jS M" }}</a></td>
                <td><a href="{{ m.match.opp_team.club.get_absolute_url }}">{{ m.match.opp_team.name }}</a>{% if m.match.kit_clash %}<i class="icon-user" title="Away kit"></i>{% endif %}</td>
                <td class="priority2">{% if m.match.time %}{{ m.match.time|time:"H:i" }}{% elif m.match.is_in_past %}???{% else %}<abbr title="Time not known">TBD</abbr>{% endif %}</td>
                <td class="priority2">{% if m.match.venue %}<a href="{{ m.match.venue.get_absolute_url }}" title="{{ m.match.venue.name }}">{{ m.match.simple_venue_name }}</a>{% elif m.match.is_in_past %}???{% else %}<abbr title="Venue not known">TBD</abbr>{% endif %}</a></td>
                <td class="center-align">{{ m.match.score_display }}</td>
                <td class="priority3">
                {% for scorer in m.scoring_appearances %}
                    <a href="{{ scorer.member.get_absolute_url }}">{{ scorer.member.last_name }}</a>{% if scorer.goals > 1 %}({{ scorer.goals }}){% endif %}{% if not forloop.last %}, {% endif %}
                {% endfor %}
                </td>
                <td class="priority3">
                {% for mom in m.mom_winners %}
                    <a href="{{ mom.member.get_absolute_url }}" title="{{ mom.comment }}">{{ mom.member.last_name }}</a>{% if not forloop.last %}, {% endif %}
                {% endfor %}
                </td>
                <td class="priority3">
                {% for lom in m.lom_winners %}
                    <a href="{{ lom.member.get_absolute_url }}" title="{{ lom.comment }}">{{ lom.member.last_name }}</a>{% if not forloop.last %}, {% endif %}
                {% endfor %}
                </td>
                <td><a href="{{ m.match.get_absolute_url }}" title="Match details"><i class="icon-file-alt"></i></a></td>
            </tr>
            {% empty %}
                {% if fill_blanks %}
                <tr>
                    <td class="priority3"><i class="icon-ban-circle" title="No match"></i></td><td class="no-break">{{ date|date:"d-M-y" }}</td><td></td><td class="priority2"></td><td class="priority2"></td><td></td><td class="priority3"></td><td class="priority3"></td><td class="priority3"></td><td></td>
                </tr>
                {% endif %}
            {% endfor %}
        {% endfor %}
        </tbody>
    </table>
{% else %}
    <p class="lead muted">No fixtures</p>
{% endif %}